[TOC]

## 网络基础

### 协议和分层

#### 协议
![alt text](image.png)
![alt text](image-1.png)
**要素**
![alt text](image-2.png)

#### 分层
![alt text](image-3.png)
![alt text](image-4.png)
![alt text](image-5.png)
![alt text](image-6.png)
![alt text](image-7.png)

### 数据组织和传输
![alt text](image-8.png)
> 使用 IP  MAC地址 C->S
> 使用端口 找到对应进程
> 
#### 流程
![alt text](image-9.png)
![alt text](image-10.png)
![alt text](image-11.png)

### TCP/IP四层模型、MAC和IP

#### TCP/IP四层模型
![alt text](image-12.png)
![alt text](image-13.png)
> 应用层的HTTP.. 相当于货物；传输层的TCP相当于搬运工具；网络层IP相当于导航；网络接口层相当于高速路。

**TCP四层详解**
![alt text](image-14.png)

#### 数据链路层的工作机制
![alt text](image-15.png)

##### MAC
![alt text](image-16.png)

> 64 - 46 = 18(6+6+2+4)
> 
![alt text](image-17.png)
![alt text](image-18.png)

![alt text](image-19.png)

#### 网络层工作机制
##### 网络层功能
![alt text](image-20.png)

##### IP协议
![alt text](image-21.png)

##### IP数据报格式
![alt text](image-22.png)

![alt text](image-23.png)


---

### ARP协议

![alt text](image-24.png)

#### 工作流程
![alt text](image-25.png)
![alt text](image-26.png)

#### ARP协议包格式
![alt text](image-27.png)

![alt text](image-28.png)
![alt text](image-29.png)

#### ARP请求应答示例
![alt text](image-30.png)
![alt text](image-31.png)

### 主机通信WAN
![alt text](image-32.png)
> 主机A通过ARP 找到局域网网关的MAC地址，封装数据给网关，网关**通过IP进行下一跳寻找到广域网路由** ，期间更新设备MAC地址；找到主机B所在的局域网网关发送ARP请求（用IP寻），主机B应答返回会MAC。

#### 流程
![alt text](image-33.png)
![alt text](image-34.png)

---
### TCP协议

#### TCP
![alt text](image-35.png)

#### TCP特点
![alt text](image-36.png)

#### TCP为什么可靠（重要）
![alt text](image-37.png)
![alt text](image-38.png)
![alt text](image-39.png)

#### TCP包头格式解析
![alt text](image-40.png)
![alt text](image-41.png)
![alt text](image-42.png)
![alt text](image-43.png)
![alt text](image-44.png)

####  TCP包头示例
![alt text](image-45.png)
![alt text](image-46.png)
![alt text](image-47.png)
![alt text](image-48.png)


---

### TCP三次握手和四次挥手

#### TCP协议的过程
![alt text](image-49.png)

![alt text](image-50.png)
![alt text](image-51.png)

#### 三次握手
（三次握手有很多问答）
![alt text](image-53.png)
![alt text](image-52.png)
![alt text](image-54.png)

#### 四次挥手
![alt text](image-56.png)
![alt text](image-55.png)
![alt text](image-57.png)

#### 抓包测试
wireshark
![alt text](image-58.png)
![alt text](image-59.png)
![alt text](image-60.png)
![alt text](image-61.png)
![alt text](image-62.png)
![alt text](image-63.png)

---

###  字节序 大端小端

#### 大端存储小端存储
![alt text](image-64.png)
![alt text](image-65.png)
![alt text](image-66.png)

#### 为什么有大小端转换问题？
![alt text](image-67.png)


#### 如何检查自己的电脑是大端还是小端？
![alt text](image-68.png)
![alt text](image-69.png)
![alt text](image-70.png)

#### C++20 大小端处理函数
![alt text](image-71.png)
![alt text](image-72.png)

![alt text](image-73.png)
![alt text](image-74.png)
![alt text](image-75.png)

---

## socket编程与TCP协议 (核心)
![alt text](image-76.png)

### socket
![alt text](image-77.png)
![alt text](image-78.png)


### 网络通信的三要素
![alt text](image-79.png)


### socket与TCP的关系
![alt text](image-80.png)
![alt text](image-81.png)

### 如何使用socket编程（流程）
![alt text](image-82.png)


### TCP服务端实现
在linux系统上部署
![alt text](image-83.png)
![alt text](image-84.png)
![alt text](image-124.png)
![alt text](image-101.png)
---

### sockaddr_in结构体
![alt text](image-102.png)
![alt text](image-103.png)
![alt text](image-104.png)
![alt text](image-105.png)
![alt text](image-106.png)


---

### socket重要数据结构和函数解析

#### socket函数

![alt text](image-85.png)
![alt text](image-86.png)
![alt text](image-87.png)
![alt text](image-88.png)

---

#### setsockopt函数

![alt text](image-89.png)
![alt text](image-90.png)

---
![alt text](image-91.png)
![alt text](image-98.png)

**SO_REUSEADDR 选项是否必须？**
![alt text](image-99.png)

![alt text](image-100.png)

---
![alt text](image-92.png)
![alt text](image-93.png)
![alt text](image-94.png)
![alt text](image-95.png)
![alt text](image-96.png)

![alt text](image-97.png)


---
#### bind函数
![alt text](image-107.png)
![alt text](image-108.png)
![alt text](image-109.png)
![alt text](image-110.png)
![alt text](image-111.png)

![alt text](image-112.png)

----
#### listen函数
![alt text](image-113.png)
![alt text](image-114.png)
![alt text](image-115.png)

![alt text](image-116.png)
![alt text](image-117.png)
![alt text](image-119.png)
![alt text](image-118.png)

---

#### accept函数
![alt text](image-120.png)
![alt text](image-121.png)
![alt text](image-122.png)
![alt text](image-123.png)
![alt text](image-125.png)
![alt text](image-126.png)

---
#### recv函数
![alt text](image-127.png)
![alt text](image-128.png)
![alt text](image-129.png)
**recv() 返回值等于 0 TCP连接关闭**
![alt text](image-130.png)
![alt text](image-131.png)

---
#### send函数
![alt text](image-132.png)
![alt text](image-133.png)
![alt text](image-134.png)
![alt text](image-139.png)
![alt text](image-138.png)
![alt text](image-135.png)
![alt text](image-136.png)
![alt text](image-137.png)

---
#### close函数
![alt text](image-140.png)
![alt text](image-141.png)
![alt text](image-142.png)
![alt text](image-143.png)

![alt text](image-145.png)
![alt text](image-146.png)

![alt text](image-144.png)
![alt text](image-147.png)

---
#### connect函数
![alt text](image-148.png)


---
### TCP客户端实现




---
### C/S交互和其他延伸

