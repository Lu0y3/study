[TOC]

### 三次握手为什么不是两次或者是四次？
```cpp
### **一、两次握手的问题**  
1. **无法确认客户端的接收能力**  
   • 若只有两次握手（客户端发送 `SYN`，服务器回复 `SYN-ACK`），服务器无法确认客户端是否具备接收能力。客户端可能因故障无法接收数据，导致服务器误判连接有效，长期维护无效连接，浪费资源。  

2. **历史重复连接的干扰**  
   • 网络延迟可能导致旧的 `SYN` 报文滞留。若客户端已通过新 `SYN` 建立连接，服务器收到旧 `SYN` 并回复 `SYN-ACK` 后，两次握手会直接建立冗余连接。  

**三次握手的解决方案**  
• 第三次握手（客户端发送 `ACK`）确认客户端能接收数据，且双方的收发能力均被验证。  
• 服务器仅在收到 `ACK` 后才建立连接，滞留的旧 `SYN` 因客户端不再回复 `ACK`，不会产生冗余连接。  

---

### **二、四次握手的不必要性**  
1. **三次握手已覆盖所有验证**  
   • 第一次握手（`SYN`）：验证客户端的发送能力。  
   • 第二次握手（`SYN-ACK`）：验证服务器的发送和接收能力。  
   • 第三次握手（`ACK`）：验证客户端的接收能力。  

2. **四次握手冗余**  
   • 若增加第四次握手（如服务器再回复 `ACK`），仅能验证服务器能接收客户端的 `ACK`，但此时连接已建立，后续数据传输会自然验证通道可用性，无需额外确认。  

---

### **三、三次握手的技术本质**  
1. **最小化交互次数**  
   • 三次是保证双方收发能力验证的最少次数：  
     ◦ 客户端→服务器（`SYN`）  
     ◦ 服务器→客户端（`SYN-ACK`）  
     ◦ 客户端→服务器（`ACK`）  

2. **可靠性与效率的平衡**  
   • 防止历史连接干扰，避免资源浪费。  
   • 以最低成本确保通道可靠性，符合网络协议设计原则。  

---

### **结论**  
• **两次握手不足**：缺少对客户端接收能力的验证，且无法防御历史连接问题。  
• **四次握手冗余**：三次已覆盖所有必要验证，增加次数无实际价值。  
• **三次握手最优**：以最小交互成本实现可靠连接，是 TCP 协议设计的核心机制。
```